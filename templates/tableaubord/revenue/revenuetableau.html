{% extends "../tableaubord.html" %}

{% block content %}
<body>
 <div class="header">
        <h1 class="page-title">Tableau des Revenus</h1>
        <div class="header-actions">
          <a href="{% url 'categorierevenue' %}" class="btn btn-primary" id="addObjectifBtn">categorie</a>         
          <a href="{% url 'ajouterrevenue' %}" class="btn btn-primary" id="addObjectifBtn">Ajouter une revenue</a> 
        </div>
     </div>
  <div class="dashboard-grid">
  <div class="card card-lg">
        <div class="card-header">
            <h2 class="card-title">Liste des revenues</h2>
            <div class="search-container">
              <input type="text" id="searchAll" class="search-box" placeholder="üîçRechercher une revenue...">
            </div>
        </div>
        {% if messages %}
        {% for message in messages %}
            <p>{{message}}</p>
        {% endfor %}
        {% endif %} 
   <div class="table-container">      
  <table id="revenueTable">
    <thead>
      <tr>
        <th>Cat√©gorie</th>
        <th>Montant</th>
        <th>Date</th>
        <th>Description</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for revenue in revenues %}
      <tr>
        <td>{{revenue.categorie.name}}</td>
        <td>{{revenue.montant}}</td>
        <td>{{revenue.date}}</td>
        <td>{{revenue.description}}</td>
        <td class="action-icons">
       <div class="item-actions">
            <a href="{% url 'detailrevenue' revenue.id %}" class="action-btn view-btn" title="Voir d√©tails">
              <i class="fas fa-eye">üëÅÔ∏è</i>
            </a>
            <a href="{% url 'modifierrevenue' revenue.id %}" class="action-btn edit-btn" title="Modifier">
              <i class="fas fa-edit">‚úèÔ∏è</i>
            </a>
            <a href="{% url 'supprimerrevenue' revenue.id %}" class="action-btn delete-btn" title="Supprimer">
              <i class="fas fa-trash-alt">üóëÔ∏è</i>
            </a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchAll = document.getElementById('searchAll');
    const table = document.getElementById('revenueTable');
    const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

    searchAll.addEventListener('input', function() {
        const value = searchAll.value.toLowerCase();
        for (let row of rows) {
            // On v√©rifie toutes les cellules sauf la derni√®re (actions)
            let found = false;
            for (let i = 0; i < row.cells.length - 1; i++) {
                if (row.cells[i].textContent.toLowerCase().includes(value)) {
                    found = true;
                    break;
                }
            }
            row.style.display = found ? '' : 'none';
        }
    });
});
</script>

{% endblock content %}