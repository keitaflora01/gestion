{% extends "../tableaubord.html" %}

{% block content %}

<body>
     <div class="header">
        <h1 class="page-title">Tableau des Depenses</h1>
        <div class="header-actions">         
          <a href="{% url 'categoriedepense' %}" class="btn btn-primary" id="addObjectifBtn">categorie</a>
          <a href="{% url 'ajouterdepense' %}" class="btn btn-primary" id="addObjectifBtn">Ajouter une depense</a>
        </div>
     </div>
  
    <div class="dashboard-grid">
      <div class="card card-lg">
        <div class="card-header">
            <h2 class="card-title">Liste des depenses</h2>
            <div class="search-container">
              <input type="text" id="searchAll" class="search-box"  placeholder="üîçRechercher une depense...">
            </div>
        </div>

        {% if messages %}
        {% for message in messages %}
            <p>{{message}}</p>
        {% endfor %}
        {% endif %}
        <div class="table-container">
        <table id="depenseTable">
          <thead>
            <tr>
     
              <th>Cat√©gorie</th>
              <th>Montant</th>
              <th>Date</th>
              <th>Description</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
          {% for depense in depenses %}
          <tr>
       
          <td>{{depense.categorie.name}}</td>
        <td>{{depense.montant}}</td>
        <td>{{depense.date}}</td>
        <td>{{depense.description}}</td>
        <td class="action-icons">
             <div class="item-actions">
                        <a href="{% url 'detaildepense' depense.id %}" class="action-btn view-btn" title="Voir d√©tails">
                           <i class="fas fa-eye">üëÅÔ∏è</i>
                        </a>
                        <a href="{% url 'modifierdepense' depense.id %}" class="action-btn edit-btn" title="Modifier">
                           <i class="fas fa-edit">‚úèÔ∏è</i>
                        </a>
                        <a href="{% url 'supprimerdepense' depense.id %}" class="action-btn delete-btn" title="Supprimer">
                          <i class="fas fa-trash-alt">üóëÔ∏è</i>
                        </a>
                    </div>
        </td>
      </tr>
      {% endfor %}
      <!-- Tu peux ajouter d'autres lignes ici -->
    </tbody>
  </table>
  </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchAll = document.getElementById('searchAll');
    const table = document.getElementById('depenseTable');
    const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

    searchAll.addEventListener('input', function() {
        const value = searchAll.value.toLowerCase();
        for (let row of rows) {
            // On v√©rifie toutes les cellules sauf la derni√®re (actions)
            let found = false;
            for (let i = 0; i < row.cells.length - 1; i++) {
                if (row.cells[i].textContent.toLowerCase().includes(value)) {
                    found = true;
                    break;
                }
            }
            row.style.display = found ? '' : 'none';
        }
    });
});
</script>
{% endblock content %}
